# ------------------ 主要配置 ------------------
astune:
  project_name: example_rubrics_judge
  task_reader:
    type: huggingface_dat_repo # ✨✨✨✨ `env_service` or `dataset_file` or `huggingface_dat_repo`
    # 如果选择 `huggingface_dat_repo` 以下配置生效
    huggingface_dat_repo:
      dataset_path: '/mnt/data_cpfs/qingxu.fu/dataset/openai/gsm8k/main'
      training_split: "train"
      validation_split: "test"

  task_judge:
    # ✨✨✨✨ 编写并选择评价函数
    judge_protocol: astune.task_judge.math_answer_as_judge->MathAnswerAsJudge

  model:
    # ✨✨✨✨ 设置待训练的模型
    path: /mnt/data_cpfs/model_cache/modelscope/hub/Qwen/Qwen/Qwen2___5-14B-Instruct

  rollout:
    agentscope_learn_protocol: "tutorial.example_rubrics_judge.math_agent->ExampleMathLearn" # ✨✨✨✨ 编写并选择Agent
    temperature: 0.7
    max_env_worker: 80
    num_repeat: 4
    agent_madness_reward: 0.0

  data:
    train_batch_size: 64

  debug:
    debug_max_parallel: 1
    debug_first_n_tasks: 1

  task_judge:
    judge_type: rubrics_auto_grader  # Options: 'customized_protocal', 'rubrics_auto_grader'
    rubrics_auto_grader:
      # rubrics begin
      model_name: qwen-max
      grader_mode: pointwise
      language: en
      min_score: 0
      max_score: 1
      success_threshold: 0.7
      sampling_mode: all_samples
      generate_number: 1
      max_epochs: 2
      max_retries: 3
      aggregation_mode: keep_all
      grader_name: Math Auto Grader
      num_reference_samples: 20
      query_field: main_query
      answer_field: final_answer
      reference_field: answer
      input_data_type: dataset_file # `env_service` or `dataset_file` or `huggingface_dat_repo`
      dataset_file:
        training:
          file_path: "tutorial/example_rm_auto_grader/rubrics_train.jsonl"


# ------------------ 不需要修改 ------------------
hydra:
  searchpath:
    - file://astune/default_config
    - file://astune/default_config/verl         # verl only
    - file://external/verl/verl/trainer/config  # verl only
    - file://astune/default_config/trinity      # trinity only

# ------------------ 不需要修改 ------------------
defaults:
  - ppo_trainer # verl inherit 1/2
  - verl_default # verl inherit 2/2
  - trinity_default # trinity inherit 1/1
  - astune_default
  - _self_
